---
import { getCollection, getEntries } from "astro:content";
import { getFileSlug } from "../../utils/fileSlug";

const { title } = Astro.props;
const services = (await getCollection("services")).map(
  (service) => service.data
);
const links = await getEntries(
  services.map((service) => ({
    collection: "pages",
    slug: getFileSlug(service.link),
  }))
);
---

<section class='services'>
  <h2>{title}</h2>
  <div class='servicesGrid'>
    {
      services.map((service, index) => (
        <a class='service' href={links[index].slug}>
          <img src={service.image} alt={service.imageAlt} />
          <h3>{service.title}</h3>
        </a>
      ))
    }
  </div>
</section>

<style lang='scss'>
  @import "../../styles/_vars.scss";
  .services {
    h2 {
      text-align: center;
      margin-bottom: $gutter;
    }
  }

  .servicesGrid {
    width: 100%;
    display: grid;
    gap: $gutter;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }

  .service {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: $gutter-small;
    img {
      height: 25rem;
      width: 100%;
      object-fit: cover;
    }
    h3 {
      color: $color-grey;
      font-size: 1.25rem;
      font-weight: bold;
    }
  }
</style>
